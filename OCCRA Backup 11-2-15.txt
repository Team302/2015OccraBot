#pragma config(Sensor, dgtl1,  launchSolenoid, sensorDigitalOut)
#pragma config(Sensor, dgtl3,  pressureSwitch, sensorDigitalIn)
#pragma config(Motor,  port1,           compressor,    tmotorVexFlashlight, openLoop, reversed)
#pragma config(Motor,  port4,           ballIn,        tmotorServoContinuousRotation, openLoop)
#pragma config(Motor,  port5,           latchServo,    tmotorServoStandard, openLoop)
#pragma config(Motor,  port8,           leftMotor,     tmotorServoContinuousRotation, openLoop)
#pragma config(Motor,  port9,           rightMotor,    tmotorServoContinuousRotation, openLoop)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

//http://content.vexrobotics.com/docs/spike-blue-guide-sep05.pdf

int servoMoving = 0;
int disarmServoMoving = 0;
int pistonMoving = 0;
int driveMode = 0; //Change this variable to change drive modes
//0 = tank mode
//1 = right stick = all arcade drive
//2 = left stick = all arcade drive
//3 = arcade right stick = forward/back, left stick = left/right
//4 = arcade right stick = left/right, left stick = forward/back

task main(){
motor[latchServo] = 0;  //initialize latch servo to locked position
while(true){

	//compressor
	if(SensorValue[pressureSwitch] == 0){ //if pressure switch cry that pressure too low
		motor[compressor] = 127;		//turn on pump to get some pressure
	}
	else{
		motor[compressor] = 0;  //if pressure switch is happy and full of pressure, then compressor can rest
	}

	//ball in
	motor[ballIn] = vexRT[Ch3Xmtr2]; //uses left vertical joystick on partner controller to bring ball in

	//launch ball
	if(vexRT[Btn6UXmtr2] == 1)         // If button 6U on partner (upper right shoulder button) is pressed:
  {
    motor[latchServo] = 90;  // Turn the servo to unlatch the trunk latch "release the kraken".
    clearTimer(T1);
    servoMoving = 1;
  }

  if((servoMoving == 1)&&(time1[T1] >= 1000)){		//this means that if the ball has been shot and it has been over 1 second, then relatch and open solonoid.
  	servoMoving = 0;
  	motor[latchServo] = 0; // Put servo back into place
  	SensorValue[launchSolenoid] = 1; //open solonoid to push cylinders to arm launcher
  	clearTimer(T3);
  	pistonMoving = 1;

  	}


  	if((pistonMoving == 1)&&(time1[T3] >= 1000)){
  		pistonMoving = 0;
  		SensorValue[launchSolenoid] = 0;
  	}
  	//disarm
  	if(vexRT[Btn7LXmtr2] == 1)         // If button 6U on partner (upper right shoulder button) is pressed:
  {
  	SensorValue[launchSolenoid] = 0;
    motor[latchServo] = 90;  // Turn the servo "release the kraken".
    clearTimer(T2);
    disarmServoMoving = 1;
  }
    if ((disarmServoMoving == 1) &&(time1[T2] >=1000)) {
    	disarmServoMoving =0;
    	motor[latchServo] =0;
  }
  switch (driveMode)
  {
  	case 0:
  //Drive mode 0 Tank Mode
  	motor[leftMotor]  = vexRT[Ch3];   // Left Joystick Y value
    motor[rightMotor] = -vexRT[Ch2];   // Right Joystick Y value
  break;
  
  case 1:
	//Drive mode 1 right stick = all arcade drive
  	motor[leftMotor]  = (vexRT[Ch1] + vexRT[Ch2])/2;  // (y + x)/2
    motor[rightMotor] = (vexRT[Ch1] - vexRT[Ch2])/2;  // (y - x)/2
    break;
    
  case 2:
	//Drive mode 2 left stick = all arcade drive
  	motor[leftMotor]  = (vexRT[Ch4] + vexRT[Ch3])/2;  // (y + x)/2
    motor[rightMotor] = (vexRT[Ch4] - vexRT[Ch3])/2;  // (y - x)/2
  break;
  
  case 3:
	//Drive mode 3 arcade right stick = forward/back, left stick = left/right
  	motor[leftMotor]  = (vexRT[Ch4] + vexRT[Ch2])/2;  // (y + x)/2
    motor[rightMotor] = (vexRT[Ch4] - vexRT[Ch2])/2;  // (y - x)/2
    break;
    
    case 4:
  //Drive mode 4 arcade right stick = left/right, left stick = forward/back
  	motor[leftMotor]  = (vexRT[Ch1] + vexRT[Ch3])/2;  // (y + x)/2
    motor[rightMotor] = (vexRT[Ch1] - vexRT[Ch3])/2;  // (y - x)/2
    break;
	}
}
}